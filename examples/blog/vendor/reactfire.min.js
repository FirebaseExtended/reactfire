'use strict';var _extends=Object.assign||function(a){for(var c,b=1;b<arguments.length;b++)for(var d in c=arguments[b],c)Object.prototype.hasOwnProperty.call(c,d)&&(a[d]=c[d]);return a},_react=require('react'),_react2=_interopRequireDefault(_react),_utils=require('./utils'),utils=_interopRequireWildcard(_utils);Object.defineProperty(exports,'__esModule',{value:!0});function _interopRequireWildcard(a){if(a&&a.__esModule)return a;var b={};if(null!=a)for(var c in a)Object.prototype.hasOwnProperty.call(a,c)&&(b[c]=a[c]);return b.default=a,b}function _interopRequireDefault(a){return a&&a.__esModule?a:{default:a}}var createAppContainer=function(a,b){if(!utils.isReactComponent(a))throw new Error('First argument to createAppContainer() must be a React component.');else if(!utils.isFirebaseApp(b))throw new Error('Second argument to createAppContainer() must be a Firebase app instance.');return function CreateAppContainer(d){return _react2.default.createElement(a,_extends({},d,{firebaseApp:b}))}};exports.default=createAppContainer;
'use strict';var _extends=Object.assign||function(a){for(var c,b=1;b<arguments.length;b++)for(var d in c=arguments[b],c)Object.prototype.hasOwnProperty.call(c,d)&&(a[d]=c[d]);return a},_createClass=function(){function a(b,c){for(var e,d=0;d<c.length;d++)e=c[d],e.enumerable=e.enumerable||!1,e.configurable=!0,'value'in e&&(e.writable=!0),Object.defineProperty(b,e.key,e)}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),_react=require('react'),_react2=_interopRequireDefault(_react),_firebase=require('firebase'),firebase=_interopRequireWildcard(_firebase),_utils=require('./utils'),utils=_interopRequireWildcard(_utils);Object.defineProperty(exports,'__esModule',{value:!0});function _interopRequireWildcard(a){if(a&&a.__esModule)return a;var b={};if(null!=a)for(var c in a)Object.prototype.hasOwnProperty.call(a,c)&&(b[c]=a[c]);return b.default=a,b}function _interopRequireDefault(a){return a&&a.__esModule?a:{default:a}}function _defineProperty(a,b,c){return b in a?Object.defineProperty(a,b,{value:c,enumerable:!0,configurable:!0,writable:!0}):a[b]=c,a}function _classCallCheck(a,b){if(!(a instanceof b))throw new TypeError('Cannot call a class as a function')}function _possibleConstructorReturn(a,b){if(!a)throw new ReferenceError('this hasn\'t been initialised - super() hasn\'t been called');return b&&('object'==typeof b||'function'==typeof b)?b:a}function _inherits(a,b){if('function'!=typeof b&&null!==b)throw new TypeError('Super expression must either be null or a function, not '+typeof b);a.prototype=Object.create(b&&b.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}}),b&&(Object.setPrototypeOf?Object.setPrototypeOf(a,b):a.__proto__=b)}var createAuthContainer=function(a){var b=1<arguments.length&&void 0!==arguments[1]?arguments[1]:'user';if(!utils.isReactComponent(a))throw new Error('First argument to createAuthContainer() must be a React component.');else if('string'!=typeof b||''===b)throw new Error('Second argument to createAuthContainer() must be a non-empty string representing a prop name.');var d,c=void 0,e=function(f){function g(h){_classCallCheck(this,g);var j=_possibleConstructorReturn(this,(g.__proto__||Object.getPrototypeOf(g)).call(this,h));return c=h.firebaseApp||firebase.app(),j.state=_defineProperty({},b,void 0),j}return _inherits(g,f),_createClass(g,[{key:'componentDidMount',value:function componentDidMount(){var h=this;d=firebase.auth(c).onAuthStateChanged(function(j){h.setState(_defineProperty({},b,j&&j.toJSON()))})}},{key:'componentWillUnmount',value:function componentWillUnmount(){d()}},{key:'render',value:function render(){return _react2.default.createElement(a,_extends({},this.props,this.state))}}]),g}(_react2.default.Component);return e.propTypes={firebaseApp:_react2.default.PropTypes.shape({name:_react2.default.PropTypes.string,options:_react2.default.PropTypes.shape({apiKey:_react2.default.PropTypes.string,authDomain:_react2.default.PropTypes.string}),delete:_react2.default.PropTypes.function})},e};exports.default=createAuthContainer;
'use strict';var _extends=Object.assign||function(a){for(var c,b=1;b<arguments.length;b++)for(var d in c=arguments[b],c)Object.prototype.hasOwnProperty.call(c,d)&&(a[d]=c[d]);return a},_createClass=function(){function a(b,c){for(var e,d=0;d<c.length;d++)e=c[d],e.enumerable=e.enumerable||!1,e.configurable=!0,'value'in e&&(e.writable=!0),Object.defineProperty(b,e.key,e)}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),_react=require('react'),_react2=_interopRequireDefault(_react),_utils=require('./utils'),utils=_interopRequireWildcard(_utils);Object.defineProperty(exports,'__esModule',{value:!0});function _interopRequireWildcard(a){if(a&&a.__esModule)return a;var b={};if(null!=a)for(var c in a)Object.prototype.hasOwnProperty.call(a,c)&&(b[c]=a[c]);return b.default=a,b}function _interopRequireDefault(a){return a&&a.__esModule?a:{default:a}}function _defineProperty(a,b,c){return b in a?Object.defineProperty(a,b,{value:c,enumerable:!0,configurable:!0,writable:!0}):a[b]=c,a}function _classCallCheck(a,b){if(!(a instanceof b))throw new TypeError('Cannot call a class as a function')}function _possibleConstructorReturn(a,b){if(!a)throw new ReferenceError('this hasn\'t been initialised - super() hasn\'t been called');return b&&('object'==typeof b||'function'==typeof b)?b:a}function _inherits(a,b){if('function'!=typeof b&&null!==b)throw new TypeError('Super expression must either be null or a function, not '+typeof b);a.prototype=Object.create(b&&b.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}}),b&&(Object.setPrototypeOf?Object.setPrototypeOf(a,b):a.__proto__=b)}var createDatabaseContainer=function(a,b){if(!utils.isReactComponent(a))throw new Error('First argument to createDatabaseContainer() must be a React component.');else if('function'!=typeof b)throw new Error('Second argument to createDatabaseContainer() must be a function.');var c=void 0,d={},e=function _unbindListeners(f){Object.keys(f).forEach(function(g){var h=f[g].ref,j=d[g];Object.keys(j).forEach(function(k){h.off(k,j[k])})}),d={}};return function(f){function g(h){_classCallCheck(this,g),console.log('CreateDatabaseContainer constructor');var j=_possibleConstructorReturn(this,(g.__proto__||Object.getPrototypeOf(g)).call(this,h));return c=b(j.props),Object.keys(c).forEach(function(k){var l=c[k];if(!utils.isNonNullObject(l))throw new Error('Unexpected reference object. Not an object.');if(!utils.isDatabaseReferenceOrQuery(l)){if(!('ref'in l))throw new Error('Reference must be a Database Reference or Query or an object with a "ref" key.');else if(!utils.isDatabaseReferenceOrQuery(l.ref))throw new Error('"ref" key must be a Database Reference or Query.');else if('asArray'in l&&'boolean'!=typeof l.asArray)throw new Error('"asArray" key must be a boolean.');Object.keys(l).forEach(function(m){if('ref'!==m&&'asArray'!==m)throw new Error('Unexpected key in ref: "'+m+'".')})}}),j.state={},Object.keys(c).forEach(function(k){var m,l=c[k];m=utils.isDatabaseReference(l)?l.key:utils.isDatabaseReference(l.ref)?l.ref.key:l.ref.ref.key,j.state[k]={key:m,value:void 0,isLoaded:!1}}),j.objectValue=j.objectValue.bind(j),j.arrayChildAdded=j.arrayChildAdded.bind(j),j.arrayChildMoved=j.arrayChildMoved.bind(j),j.arrayChildChanged=j.arrayChildChanged.bind(j),j.arrayChildRemoved=j.arrayChildRemoved.bind(j),j}return _inherits(g,f),_createClass(g,[{key:'componentDidMount',value:function componentDidMount(){console.log('CreateDatabaseContainer.componentDidMount()'),this.bindListeners(this.props)}},{key:'componentWillUnmount',value:function componentWillUnmount(){console.log('CreateDatabaseContainer.componentWillUnmount()'),e(c)}},{key:'componentWillReceiveProps',value:function componentWillReceiveProps(h){console.log('CreateDatabaseContainer.componentWillReceiveProps()',this.props,h)}},{key:'objectValue',value:function objectValue(h,j){console.log('objectValue() called',h,j.val()),this.setState(function(){return _defineProperty({},h,{key:j.key,val:j.val(),isLoaded:!0})})}},{key:'arrayChildAdded',value:function arrayChildAdded(h,j,k){console.log('arrayChildAdded() called',h,j.val()),this.setState(function(l){var p,m=j.key,n=j.val(),o=l[h].value||[];if(null===k)p=0;else{var q=utils.indexForKey(o,k);p=q+1}return o.splice(p,0,{key:m,value:n}),_defineProperty({},h,{key:l[h].key,value:o,isLoaded:!0})})}},{key:'arrayChildRemoved',value:function arrayChildRemoved(h,j){console.log('arrayChildRemoved() called',h),this.setState(function(k){var l=k[h].value,m=utils.indexForKey(l,j.key);return l.splice(m,1),_defineProperty({},h,{key:k[h].key,value:l,isLoaded:!0})})}},{key:'arrayChildChanged',value:function arrayChildChanged(h,j){console.log('arrayChildChanged() called',h),this.setState(function(k){var l=j.key,m=j.val(),n=k[h].value,o=utils.indexForKey(n,l);return n[o]={key:l,value:m},_defineProperty({},h,{key:k[h].key,value:n,isLoaded:!0})})}},{key:'arrayChildMoved',value:function arrayChildMoved(h,j,k){console.log('arrayChildMoved() called',h),this.setState(function(l){var q,m=j.key,n=l[h].value,o=utils.indexForKey(n,m),p=n.splice(o,1)[0];if(null===k)q=0;else{var r=utils.indexForKey(n,k);q=r+1}return n.splice(q,0,p),_defineProperty({},h,{key:l[h].key,value:n,isLoaded:!0})})}},{key:'bindListeners',value:function bindListeners(h){var j=this;console.log('CreateDatabaseContainer.bindListeners()');var k=b(h);Object.keys(k).forEach(function(l){var p,m=c[l],n=k[l],o=!1;'on'in n||(o=!!n.asArray,n=n.ref,p=n.cancelCallback),'on'in m||(m=m.ref);var q='undefined'==typeof m,r=q&&!n.isEqual(m),s=q&&m.asArray!==o;(!q||r||s)&&(o?(console.log('AS ARRAY',l),d[l]={value:n.once('value',function(t){t.exists()||j.setState(function(u){return _defineProperty({},l,{key:u[l].key,value:[],isLoaded:!0})})}),child_added:n.on('child_added',j.arrayChildAdded.bind(j,l),p),child_removed:n.on('child_removed',j.arrayChildRemoved.bind(j,l),p),child_changed:n.on('child_changed',j.arrayChildChanged.bind(j,l),p),child_moved:n.on('child_moved',j.arrayChildMoved.bind(j,l),p)}):(console.log('AS OBJECT',l),d[l]={value:n.on('value',j.objectValue.bind(j,l),p)}))}),c=k}},{key:'render',value:function render(){return console.log('CreateDatabaseContainer.render()',this.props,this.state),_react2.default.createElement(a,_extends({},this.props,this.state))}}]),g}(_react2.default.Component)};exports.default=createDatabaseContainer;
'use strict';Object.defineProperty(exports,'__esModule',{value:!0}),exports.createAuthContainer=exports.createAppContainer=void 0;var _createAppContainer=require('./createAppContainer'),_createAppContainer2=_interopRequireDefault(_createAppContainer),_createAuthContainer=require('./createAuthContainer'),_createAuthContainer2=_interopRequireDefault(_createAuthContainer);function _interopRequireDefault(a){return a&&a.__esModule?a:{default:a}}exports.createAppContainer=_createAppContainer2.default,exports.createAuthContainer=_createAuthContainer2.default;
'use strict';var _typeof='function'==typeof Symbol&&'symbol'==typeof Symbol.iterator?function(a){return typeof a}:function(a){return a&&'function'==typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?'symbol':typeof a};Object.defineProperty(exports,'__esModule',{value:!0});exports.isFunction=isFunction,exports.isNonNullObject=isNonNullObject,exports.isDatabaseReference=isDatabaseReference,exports.isDatabaseQuery=isDatabaseQuery,exports.isDatabaseReferenceOrQuery=isDatabaseReferenceOrQuery,exports.isFirebaseApp=isFirebaseApp,exports.isReactComponent=isReactComponent;function isFunction(a){return'function'==typeof a}function isNonNullObject(a){return'[object Object]'===Object.prototype.toString.call(a)}function isDatabaseReference(a){return isNonNullObject(a)&&'object'===_typeof(a.ref)&&'function'==typeof a.on&&'function'==typeof a.set&&'function'==typeof a.once&&'function'==typeof a.transaction}function isDatabaseQuery(a){return isNonNullObject(a)&&'object'===_typeof(a.ref)&&'function'==typeof a.on&&'function'==typeof a.once&&'function'==typeof a.endAt&&'function'==typeof a.orderByChild}function isDatabaseReferenceOrQuery(a){return isDatabaseReference(a)||isDatabaseQuery(a)}function isFirebaseApp(a){return isNonNullObject(a)&&'string'==typeof a.name&&'object'===_typeof(a.options)&&'function'==typeof a.delete}function isReactComponent(a){return isNonNullObject(a)||isFunction(a)}
